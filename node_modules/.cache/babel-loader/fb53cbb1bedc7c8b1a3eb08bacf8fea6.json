{"ast":null,"code":"import { put, takeLatest, all, call } from 'redux-saga/effects';\nimport { AppActions, postLogin, postLogout } from \"../actions\";\nimport { baseAPIResource } from \"../utils/apiHelper\";\nimport { createBrowserHistory } from 'history';\nconst newHistory = createBrowserHistory(); // function* fetchNews() {\n//   const json = yield fetch('https://newsapi.org/v1/articles?source=cnn&apiKey=c39a26d9c12f48dba2a5c00e35684ecc')\n//     .then(response => response.json());\n//   yield put({ type: \"NEWS_RECEIVED\", json: json.articles || [{ error: json.message }] });\n// }\n\nfunction* doLoginAndGetData(action) {\n  try {\n    const _action$payload = action.payload,\n          username = _action$payload.username,\n          password = _action$payload.password;\n    const response = yield call(baseAPIResource.get, \"people/?search=\".concat(username));\n    const results = response.data.results;\n    const userData = results.length ? results.filter(user => user.birth_year == password) : [];\n    const isValidUser = userData.length;\n\n    if (!isValidUser) {\n      alert(\"Invalid credentials\");\n    } else {\n      yield put(postLogin(userData)); // yield put(newHistory.push(\"/planets\"));\n    }\n\n    debugger;\n  } catch (e) {\n    console.log(\"Login error: \", e);\n  }\n}\n\nfunction* doLogout() {\n  try {\n    yield put(postLogout());\n  } catch (e) {\n    console.log(\"Logout error: \", e);\n  }\n}\n\nfunction* actionWatcher() {\n  yield takeLatest(AppActions.LOGIN_CLICKED, doLoginAndGetData);\n  yield takeLatest(AppActions.LOGOUT_CLICKED, doLogout);\n}\n\nexport default function* rootSaga() {\n  yield all([actionWatcher()]);\n}","map":{"version":3,"sources":["/Users/sharvankumar/brainstorm/swapi/swapi/src/sagas/index.js"],"names":["put","takeLatest","all","call","AppActions","postLogin","postLogout","baseAPIResource","createBrowserHistory","newHistory","doLoginAndGetData","action","payload","username","password","response","get","results","data","userData","length","filter","user","birth_year","isValidUser","alert","e","console","log","doLogout","actionWatcher","LOGIN_CLICKED","LOGOUT_CLICKED","rootSaga"],"mappings":"AAAA,SAASA,GAAT,EAAcC,UAAd,EAA0BC,GAA1B,EAA+BC,IAA/B,QAA2C,oBAA3C;AACA,SAASC,UAAT,EAAqBC,SAArB,EAAgCC,UAAhC,QAAkD,YAAlD;AACA,SAASC,eAAT,QAAgC,oBAAhC;AACA,SAASC,oBAAT,QAAqC,SAArC;AAEA,MAAMC,UAAU,GAAGD,oBAAoB,EAAvC,C,CAEA;AAEA;AACA;AAEA;AACA;;AAEA,UAAUE,iBAAV,CAA4BC,MAA5B,EAAoC;AAClC,MAAI;AAAA,4BAC6BA,MAAM,CAACC,OADpC;AAAA,UACMC,QADN,mBACMA,QADN;AAAA,UACgBC,QADhB,mBACgBA,QADhB;AAEF,UAAMC,QAAQ,GAAG,MAAMZ,IAAI,CAACI,eAAe,CAACS,GAAjB,2BAAwCH,QAAxC,EAA3B;AACA,UAAMI,OAAO,GAAGF,QAAQ,CAACG,IAAT,CAAcD,OAA9B;AACA,UAAME,QAAQ,GAAGF,OAAO,CAACG,MAAR,GAAiBH,OAAO,CAACI,MAAR,CAAeC,IAAI,IAAKA,IAAI,CAACC,UAAL,IAAmBT,QAA3C,CAAjB,GAAyE,EAA1F;AACA,UAAMU,WAAW,GAAGL,QAAQ,CAACC,MAA7B;;AAEA,QAAI,CAACI,WAAL,EAAkB;AAChBC,MAAAA,KAAK,CAAC,qBAAD,CAAL;AACD,KAFD,MAEO;AACL,YAAMzB,GAAG,CAACK,SAAS,CAACc,QAAD,CAAV,CAAT,CADK,CAGL;AACD;;AACD;AACD,GAfD,CAeE,OAAOO,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BF,CAA7B;AACD;AACF;;AAED,UAAUG,QAAV,GAAqB;AACnB,MAAI;AACF,UAAM7B,GAAG,CAACM,UAAU,EAAX,CAAT;AACD,GAFD,CAEE,OAAOoB,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BF,CAA9B;AACD;AACF;;AAED,UAAUI,aAAV,GAA0B;AACxB,QAAM7B,UAAU,CAACG,UAAU,CAAC2B,aAAZ,EAA2BrB,iBAA3B,CAAhB;AACA,QAAMT,UAAU,CAACG,UAAU,CAAC4B,cAAZ,EAA4BH,QAA5B,CAAhB;AACD;;AAGD,eAAe,UAAUI,QAAV,GAAqB;AAClC,QAAM/B,GAAG,CAAC,CACR4B,aAAa,EADL,CAAD,CAAT;AAGD","sourcesContent":["import { put, takeLatest, all, call } from 'redux-saga/effects';\nimport { AppActions, postLogin, postLogout } from \"../actions\";\nimport { baseAPIResource } from \"../utils/apiHelper\";\nimport { createBrowserHistory } from 'history';\n\nconst newHistory = createBrowserHistory();\n\n// function* fetchNews() {\n\n//   const json = yield fetch('https://newsapi.org/v1/articles?source=cnn&apiKey=c39a26d9c12f48dba2a5c00e35684ecc')\n//     .then(response => response.json());\n\n//   yield put({ type: \"NEWS_RECEIVED\", json: json.articles || [{ error: json.message }] });\n// }\n\nfunction* doLoginAndGetData(action) {\n  try {\n    const { username, password } = action.payload;\n    const response = yield call(baseAPIResource.get, `people/?search=${username}`);\n    const results = response.data.results;\n    const userData = results.length ? results.filter(user => (user.birth_year == password)) : [];\n    const isValidUser = userData.length;\n\n    if (!isValidUser) {\n      alert(\"Invalid credentials\");\n    } else {\n      yield put(postLogin(userData));\n\n      // yield put(newHistory.push(\"/planets\"));\n    }\n    debugger;\n  } catch (e) {\n    console.log(\"Login error: \", e);\n  }\n}\n\nfunction* doLogout() {\n  try {\n    yield put(postLogout());\n  } catch (e) {\n    console.log(\"Logout error: \", e);\n  }\n}\n\nfunction* actionWatcher() {\n  yield takeLatest(AppActions.LOGIN_CLICKED, doLoginAndGetData);\n  yield takeLatest(AppActions.LOGOUT_CLICKED, doLogout);\n}\n\n\nexport default function* rootSaga() {\n  yield all([\n    actionWatcher(),\n  ]);\n}"]},"metadata":{},"sourceType":"module"}